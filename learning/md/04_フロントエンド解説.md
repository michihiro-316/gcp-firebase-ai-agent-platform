# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è§£èª¬

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘   ğŸ¨ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è§£èª¬                                                       â•‘
â•‘                                                                              â•‘
â•‘   ã€Œãˆï¼ŸReactã£ã¦ãƒ¬ã‚´ãƒ–ãƒ­ãƒƒã‚¯ã¿ãŸã„ãªã‚‚ã®ï¼Ÿã€                                   â•‘
â•‘   ã€Œãã†ï¼ç”»é¢ã®ãƒ‘ãƒ¼ãƒ„ã‚’çµ„ã¿åˆã‚ã›ã¦ä½œã‚‹ã‚“ã ï¼ã€                                â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ã“ã®ç« ã§å­¦ã¶ã“ã¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“š å­¦ç¿’ç›®æ¨™                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. Reactã®åŸºæœ¬æ¦‚å¿µï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€JSXï¼‰                                    â”‚
â”‚  2. useState ã¨ useEffect ã®ä»•çµ„ã¿                                          â”‚
â”‚  3. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œã‚Šæ–¹ã¨ä½¿ã„æ–¹                                            â”‚
â”‚  4. èªè¨¼å‡¦ç†ã®æµã‚Œï¼ˆuseAuth.tsï¼‰                                             â”‚
â”‚  5. ãƒãƒ£ãƒƒãƒˆå‡¦ç†ã®æµã‚Œï¼ˆuseChat.tsï¼‰                                         â”‚
â”‚  6. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®ä»•çµ„ã¿ï¼ˆuseSessions.tsï¼‰                                  â”‚
â”‚  7. APIé€šä¿¡ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼ˆapi.tsï¼‰                                        â”‚
â”‚  8. TypeScriptã®å‹ã‚·ã‚¹ãƒ†ãƒ                                                    â”‚
â”‚                                                                             â”‚
â”‚  â±ï¸ æƒ³å®šå­¦ç¿’æ™‚é–“: 45åˆ†                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä½¿ã£ã¦ã„ã‚‹æŠ€è¡“

| æŠ€è¡“ | å½¹å‰² | ãªãœä½¿ã†ï¼Ÿ |
|------|------|----------|
| **React** | UIã‚’ä½œã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ç”»é¢ã‚’çµ„ã¿ç«‹ã¦ã‚‰ã‚Œã‚‹ |
| **TypeScript** | å‹ã®ã‚ã‚‹JavaScript | é–“é•ã„ã‚’äº‹å‰ã«é˜²ã’ã‚‹ |
| **Vite** | é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãƒ»ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ« | è¶…é«˜é€Ÿï¼å¤‰æ›´ãŒå³åº§ã«åæ˜  |
| **Firebase SDK** | Firebaseé€£æº | èªè¨¼ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç°¡å˜ã«ä½¿ãˆã‚‹ |

---

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
frontend/src/
â”œâ”€â”€ App.tsx              â† ğŸ¯ ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆã“ã“ã‹ã‚‰å§‹ã¾ã‚‹ï¼‰
â”œâ”€â”€ main.tsx             â† ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆReactã®èµ·å‹•ï¼‰
â”œâ”€â”€ hooks/               â† ğŸ£ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ï¼ˆãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨ï¼‰
â”‚   â”œâ”€â”€ useAuth.ts       â† ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
â”‚   â”œâ”€â”€ useChat.ts       â† ãƒãƒ£ãƒƒãƒˆå‡¦ç†
â”‚   â””â”€â”€ useSessions.ts   â† ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆè¤‡æ•°ä¼šè©±ã®ä¿å­˜ï¼‰
â”œâ”€â”€ services/            â† å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº
â”‚   â”œâ”€â”€ firebase.ts      â† FirebaseåˆæœŸåŒ–
â”‚   â””â”€â”€ api.ts           â† APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ components/          â† UIãƒ‘ãƒ¼ãƒ„
â”‚   â”œâ”€â”€ ChatScreen.tsx   â† ãƒãƒ£ãƒƒãƒˆç”»é¢
â”‚   â””â”€â”€ LoginScreen.tsx  â† ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
â””â”€â”€ renderers/           â† ã€ä¸Šç´šè€…å‘ã‘ã€‘ãƒãƒ£ãƒƒãƒˆè¡¨ç¤ºã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¡ å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ã¾ãšç†è§£ã™ã¹ããƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå„ªå…ˆé †ä½é †ï¼‰:                                         â”‚
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£  App.tsx          â† å…¨ä½“ã®æµã‚Œã‚’æŠŠæ¡                                     â”‚
â”‚  2ï¸âƒ£  useAuth.ts       â† èªè¨¼ã®ä»•çµ„ã¿                                        â”‚
â”‚  3ï¸âƒ£  useChat.ts       â† ãƒãƒ£ãƒƒãƒˆã®ä»•çµ„ã¿                                     â”‚
â”‚  4ï¸âƒ£  useSessions.ts   â† ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†                                       â”‚
â”‚  5ï¸âƒ£  api.ts           â† APIé€šä¿¡ã®ä»•çµ„ã¿                                      â”‚
â”‚                                                                             â”‚
â”‚  renderers/ ã¯ä¸Šç´šè€…å‘ã‘ã€‚æœ€åˆã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¦OKï¼                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Reactã®åŸºæœ¬æ¦‚å¿µ

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã¯ï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§± ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ = ç”»é¢ã®ãƒ‘ãƒ¼ãƒ„ï¼ˆãƒ¬ã‚´ãƒ–ãƒ­ãƒƒã‚¯ï¼‰                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  Appï¼ˆè¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰                                            â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚   â”‚  â”‚  LoginScreen          ã¾ãŸã¯         ChatScreen              â”‚ â”‚    â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ LoginButton â”‚                    â”‚ SessionList        â”‚ â”‚ â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ MessageList        â”‚ â”‚ â”‚    â”‚
â”‚   â”‚  â”‚                                      â”‚ InputField         â”‚ â”‚ â”‚    â”‚
â”‚   â”‚  â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚   ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ„ã¿åˆã‚ã›ã¦ç”»é¢å…¨ä½“ã‚’ä½œã‚‹ï¼                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### JSXï¼ˆJavaScript + HTMLï¼‰

Reactã§ã¯JSXã¨ã„ã†è¨˜æ³•ã‚’ä½¿ã„ã¾ã™ã€‚
JavaScript ã®ä¸­ã« HTML ã£ã½ãæ›¸ã‘ã‚‹ï¼

```tsx
// ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¾‹
function MyButton() {
  // JavaScript ã®ä¸­ã« HTML ã£ã½ãæ›¸ã‘ã‚‹ï¼
  return <button>ã‚¯ãƒªãƒƒã‚¯</button>;
}

// ä½¿ã†å´
function App() {
  return (
    <div>
      <h1>ã“ã‚“ã«ã¡ã¯</h1>
      <MyButton />  {/* â† è‡ªä½œã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ã† */}
    </div>
  );
}
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ JSXã®ç‰¹å¾´                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  âœ… HTML ã£ã½ãæ›¸ã‘ã‚‹ï¼ˆã§ã‚‚å®Ÿã¯ JavaScriptï¼‰                                  â”‚
â”‚  âœ… {} ã®ä¸­ã« JavaScript ã‚’æ›¸ã‘ã‚‹                                            â”‚
â”‚  âœ… è‡ªä½œã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ <MyComponent /> ã®ã‚ˆã†ã«ä½¿ã†                          â”‚
â”‚  âœ… class ã¯ className ã¨æ›¸ãï¼ˆJSã®äºˆç´„èªã ã‹ã‚‰ï¼‰                             â”‚
â”‚                                                                             â”‚
â”‚  ä¾‹:                                                                        â”‚
â”‚  const name = "å¤ªéƒ";                                                       â”‚
â”‚  return <h1>ã“ã‚“ã«ã¡ã¯ã€{name}ã•ã‚“ï¼</h1>;                                   â”‚
â”‚  // â†’ "ã“ã‚“ã«ã¡ã¯ã€å¤ªéƒã•ã‚“ï¼" ã¨è¡¨ç¤ºã•ã‚Œã‚‹                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. useState - çŠ¶æ…‹ç®¡ç†ã®åŸºæœ¬

### useState ã¨ã¯ï¼Ÿ

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã€ŒçŠ¶æ…‹ï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰ã€ã‚’æŒã¤ãŸã‚ã®ä»•çµ„ã¿ã€‚
çŠ¶æ…‹ãŒå¤‰ã‚ã‚‹ã¨ã€ç”»é¢ãŒè‡ªå‹•ã§å†æç”»ã•ã‚Œã‚‹ï¼

```tsx
import { useState } from 'react';

function Counter() {
  // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  // â”‚ useState(åˆæœŸå€¤) ã®æˆ»ã‚Šå€¤:                                       â”‚
  // â”‚   [0] ç¾åœ¨ã®å€¤ï¼ˆcountï¼‰                                          â”‚
  // â”‚   [1] å€¤ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°ï¼ˆsetCountï¼‰                                â”‚
  // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  const [count, setCount] = useState(0);  // åˆæœŸå€¤ã¯ 0

  return (
    <div>
      <p>ã‚«ã‚¦ãƒ³ãƒˆ: {count}</p>
      <button onClick={() => setCount(count + 1)}>
        +1
      </button>
    </div>
  );
}
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ useState ã®å‹•ä½œ                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   1. æœ€åˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°                                                      â”‚
â”‚      count = 0                                                              â”‚
â”‚      ç”»é¢: ã€Œã‚«ã‚¦ãƒ³ãƒˆ: 0ã€                                                   â”‚
â”‚                                                                             â”‚
â”‚   2. ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯                                                        â”‚
â”‚      setCount(0 + 1) ãŒå‘¼ã°ã‚Œã‚‹                                             â”‚
â”‚                                                                             â”‚
â”‚   3. React ãŒå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°                                                  â”‚
â”‚      count = 1                                                              â”‚
â”‚      ç”»é¢: ã€Œã‚«ã‚¦ãƒ³ãƒˆ: 1ã€ â† è‡ªå‹•ã§æ›´æ–°ï¼                                     â”‚
â”‚                                                                             â”‚
â”‚   âš ï¸ ç›´æ¥ count = 1 ã¨æ›¸ã„ã¦ã‚‚ç”»é¢ã¯æ›´æ–°ã•ã‚Œãªã„ï¼                            â”‚
â”‚      å¿…ãš setCount() ã‚’ä½¿ã†ï¼                                                â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é…åˆ—ã®åˆ†å‰²ä»£å…¥

```tsx
// ã“ã‚Œä½•ï¼Ÿã¨æ€ã£ãŸäººã¸
const [count, setCount] = useState(0);

// â†‘ ã¯ä»¥ä¸‹ã¨åŒã˜æ„å‘³
const result = useState(0);      // [0, é–¢æ•°] ãŒè¿”ã£ã¦ãã‚‹
const count = result[0];         // ç¾åœ¨ã®å€¤
const setCount = result[1];      // æ›´æ–°é–¢æ•°

// ã€Œé…åˆ—ã®åˆ†å‰²ä»£å…¥ã€ã¨ã„ã† JavaScript ã®æ©Ÿèƒ½
// é…åˆ—ã®è¦ç´ ã‚’å¤‰æ•°ã«å±•é–‹ã§ãã‚‹
const [first, second] = [1, 2];  // first = 1, second = 2
```

---

## 3. useEffect - å‰¯ä½œç”¨ã®å‡¦ç†

### useEffect ã¨ã¯ï¼Ÿ

ã€Œå‰¯ä½œç”¨ï¼ˆSide Effectï¼‰ã€ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã€‚
å‰¯ä½œç”¨ = ç”»é¢æç”»ä»¥å¤–ã®å‡¦ç†ï¼ˆAPIå‘¼ã³å‡ºã—ã€ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ãªã©ï¼‰

```tsx
import { useState, useEffect } from 'react';

function UserProfile() {
  const [user, setUser] = useState(null);

  // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  // â”‚ useEffect(å‡¦ç†, ä¾å­˜é…åˆ—)                                        â”‚
  // â”‚   å‡¦ç†: å®Ÿè¡Œã—ãŸã„é–¢æ•°                                            â”‚
  // â”‚   ä¾å­˜é…åˆ—: ã“ã®å€¤ãŒå¤‰ã‚ã£ãŸã‚‰å†å®Ÿè¡Œ                               â”‚
  // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  useEffect(() => {
    // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚ŒãŸã¨ãã«å®Ÿè¡Œ
    fetchUser().then(data => setUser(data));
  }, []);  // [] = æœ€åˆã®1å›ã ã‘å®Ÿè¡Œ

  return <div>{user?.name}</div>;
}
```

### ä¾å­˜é…åˆ—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³

```tsx
// ãƒ‘ã‚¿ãƒ¼ãƒ³1: æœ€åˆã®1å›ã ã‘å®Ÿè¡Œ
useEffect(() => {
  console.log("ãƒã‚¦ãƒ³ãƒˆæ™‚ã«1å›ã ã‘");
}, []);

// ãƒ‘ã‚¿ãƒ¼ãƒ³2: ç‰¹å®šã®å€¤ãŒå¤‰ã‚ã£ãŸã‚‰å®Ÿè¡Œ
useEffect(() => {
  console.log("userId ãŒå¤‰ã‚ã£ãŸã‚‰å®Ÿè¡Œ");
  fetchUserData(userId);
}, [userId]);  // userId ãŒå¤‰ã‚ã‚‹ãŸã³ã«å®Ÿè¡Œ

// ãƒ‘ã‚¿ãƒ¼ãƒ³3: æ¯å›å®Ÿè¡Œï¼ˆéæ¨å¥¨ï¼‰
useEffect(() => {
  console.log("æ¯ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§å®Ÿè¡Œ");
});  // ä¾å­˜é…åˆ—ãªã— = æ¯å›å®Ÿè¡Œ

// ãƒ‘ã‚¿ãƒ¼ãƒ³4: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–¢æ•°ä»˜ã
useEffect(() => {
  const subscription = subscribeToData();

  // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ¶ˆãˆã‚‹ã¨ãã«å®Ÿè¡Œ
  return () => {
    subscription.unsubscribe();
  };
}, []);
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¯ useEffect ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸€ç”Ÿ:                                                      â”‚
â”‚                                                                             â”‚
â”‚   [ãƒã‚¦ãƒ³ãƒˆ] â”€â”€â”€â”€â”€â†’ [æ›´æ–°] â”€â”€â”€â”€â”€â†’ [æ›´æ–°] â”€â”€â”€â”€â”€â†’ [ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆ]                 â”‚
â”‚       â†“                â†“            â†“                â†“                      â”‚
â”‚   useEffect        ä¾å­˜é…åˆ—ã®     ä¾å­˜é…åˆ—ã®      ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—               â”‚
â”‚   å®Ÿè¡Œ             å€¤ãŒå¤‰ã‚ã£ãŸ   å€¤ãŒå¤‰ã‚ã£ãŸ      é–¢æ•°å®Ÿè¡Œ                    â”‚
â”‚                    ã‚‰å†å®Ÿè¡Œ       ã‚‰å†å®Ÿè¡Œ                                    â”‚
â”‚                                                                             â”‚
â”‚   ãƒã‚¦ãƒ³ãƒˆ = ç”»é¢ã«è¡¨ç¤ºã•ã‚ŒãŸã¨ã                                             â”‚
â”‚   ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆ = ç”»é¢ã‹ã‚‰æ¶ˆãˆãŸã¨ã                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ - ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨

### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¨ã¯ï¼Ÿ

`use` ã§å§‹ã¾ã‚‹é–¢æ•°ã€‚useState ã‚„ useEffect ã‚’çµ„ã¿åˆã‚ã›ã¦ã€
ãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã™ã‚‹ã€‚

```tsx
// ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œã‚‹
function useCounter(initialValue = 0) {
  const [count, setCount] = useState(initialValue);

  const increment = () => setCount(count + 1);
  const decrement = () => setCount(count - 1);
  const reset = () => setCount(initialValue);

  return { count, increment, decrement, reset };
}

// ä½¿ã†å´A
function ComponentA() {
  const { count, increment } = useCounter(0);
  return <button onClick={increment}>{count}</button>;
}

// ä½¿ã†å´B
function ComponentB() {
  const { count, increment, reset } = useCounter(100);
  // ComponentA ã¨ã¯åˆ¥ã®çŠ¶æ…‹ã‚’æŒã¤ï¼
  return (
    <div>
      <span>{count}</span>
      <button onClick={increment}>+</button>
      <button onClick={reset}>ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  );
}
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ¨ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ãƒ¡ãƒªãƒƒãƒˆ                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨                                                         â”‚
â”‚     åŒã˜å‡¦ç†ã‚’è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ã„å›ã›ã‚‹                                 â”‚
â”‚                                                                             â”‚
â”‚  2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¹ãƒƒã‚­ãƒª                                                  â”‚
â”‚     è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ•ãƒƒã‚¯ã«åˆ†é›¢ â†’ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯è¡¨ç¤ºã«å°‚å¿µ                   â”‚
â”‚                                                                             â”‚
â”‚  3. ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„                                                           â”‚
â”‚     UIãªã—ã§ãƒ­ã‚¸ãƒƒã‚¯ã ã‘ãƒ†ã‚¹ãƒˆã§ãã‚‹                                          â”‚
â”‚                                                                             â”‚
â”‚  âš ï¸ ãƒ«ãƒ¼ãƒ«:                                                                  â”‚
â”‚     - åå‰ã¯å¿…ãš use ã§å§‹ã‚ã‚‹ï¼ˆä¾‹: useAuth, useChatï¼‰                         â”‚
â”‚     - ãƒ•ãƒƒã‚¯ã¯ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§ã®ã¿å‘¼ã³å‡ºã™ï¼ˆifæ–‡ã®ä¸­ã¯ãƒ€ãƒ¡ï¼‰                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. App.tsx - ã‚¢ãƒ—ãƒªã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

ã“ã®ã‚¢ãƒ—ãƒªã®ã€Œè¦ªç‰ã€ã€‚å…¨ä½“ã®æµã‚Œã‚’ç®¡ç†ã—ã¾ã™ã€‚

### å®Œå…¨ãªã‚³ãƒ¼ãƒ‰ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆä»˜ãï¼‰

```tsx
/**
 * App.tsx - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
 *
 * å½¹å‰²:
 *   - æœªãƒ­ã‚°ã‚¤ãƒ³ â†’ LoginScreen ã‚’è¡¨ç¤º
 *   - ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆ â†’ ChatScreen ã‚’è¡¨ç¤º
 */
import { ChatScreen } from './components/ChatScreen'
import { LoginScreen } from './components/LoginScreen'
import { useAuth } from './hooks/useAuth'
import { useChat } from './hooks/useChat'
import { useSessions } from './hooks/useSessions'

/**
 * ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰: é–‹ç™ºç’°å¢ƒã§ã®ã¿æœ‰åŠ¹
 * - true: èªè¨¼ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãƒãƒ£ãƒƒãƒˆç”»é¢ã‚’è¡¨ç¤ºï¼ˆç”»é¢ç¢ºèªç”¨ï¼‰
 * - false: é€šå¸¸ã®èªè¨¼ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨
 */
const DEBUG_SHOW_CHAT = import.meta.env.DEV && import.meta.env.VITE_DEBUG_MODE === 'true'

function App() {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ã£ã¦çŠ¶æ…‹ã‚’å–å¾—
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  // èªè¨¼çŠ¶æ…‹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€ãƒ­ã‚°ã‚¤ãƒ³é–¢æ•°ãªã©ï¼‰
  const { user, loading, error: authError, loginWithGoogle, logout } = useAuth()

  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆè¤‡æ•°ã®ä¼šè©±ã‚’ç®¡ç†ï¼‰
  const {
    sessions,              // ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§
    activeSession,         // ç¾åœ¨é¸æŠä¸­ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³
    activeSessionId,       // ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
    createSession,         // æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ
    switchSession,         // ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
    closeSession,          // ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤
    updateSessionMessages, // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ›´æ–°
  } = useSessions()

  // ãƒãƒ£ãƒƒãƒˆçŠ¶æ…‹ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€é€ä¿¡é–¢æ•°ãªã©ï¼‰
  const { messages, isLoading, error: chatError, sendMessage } = useChat({
    activeSession,
    onMessagesUpdate: updateSessionMessages,
  })

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // æ¡ä»¶åˆ†å²ã§è¡¨ç¤ºã™ã‚‹ç”»é¢ã‚’æ±ºå®š
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ï¼ˆèªè¨¼çŠ¶æ…‹ã®ç¢ºèªä¸­ï¼‰
  if (loading && !DEBUG_SHOW_CHAT) {
    return (
      <div className="loading-screen">
        <div className="spinner" />
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
      </div>
    )
  }

  // æœªãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‚’è¡¨ç¤º
  if (!user && !DEBUG_SHOW_CHAT) {
    return <LoginScreen onLogin={loginWithGoogle} error={authError} />
  }

  // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ â†’ ãƒãƒ£ãƒƒãƒˆç”»é¢ã‚’è¡¨ç¤º
  const displayUser = user || { email: 'demo@example.com', displayName: 'Demo User' }

  return (
    <ChatScreen
      user={displayUser}
      messages={messages}
      isLoading={isLoading}
      error={chatError}
      onSendMessage={sendMessage}
      onLogout={logout}
      sessions={sessions}
      activeSessionId={activeSessionId}
      onSelectSession={switchSession}
      onNewSession={createSession}
      onCloseSession={closeSession}
    />
  )
}

export default App
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” App.tsx ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚   â”‚  App èµ·å‹•   â”‚                                                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â–¼                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ loading?   â”‚â”€â”€â”€â”€â–¶â”‚ ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢è¡¨ç¤ºï¼ˆã‚¹ãƒ”ãƒŠãƒ¼ï¼‰                  â”‚   â”‚
â”‚   â”‚   true     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚         â”‚ false                                                             â”‚
â”‚         â–¼                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  user?     â”‚â”€â”€â”€â”€â–¶â”‚ LoginScreenï¼ˆãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼‰                       â”‚   â”‚
â”‚   â”‚   null     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚         â”‚ user ã‚ã‚Š                                                         â”‚
â”‚         â–¼                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ChatScreenï¼ˆãƒãƒ£ãƒƒãƒˆç”»é¢ï¼‰                                           â”‚   â”‚
â”‚   â”‚  - ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§                                                    â”‚   â”‚
â”‚   â”‚  - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º                                                    â”‚   â”‚
â”‚   â”‚  - å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ                                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. useAuth.ts - èªè¨¼ãƒ•ãƒƒã‚¯ã®å®Œå…¨è§£èª¬

### å®Œå…¨ãªã‚³ãƒ¼ãƒ‰

```tsx
/**
 * èªè¨¼ãƒ•ãƒƒã‚¯
 *
 * Firebase Authenticationã®çŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚
 */
import { useState, useEffect } from 'react'
import { User, signInWithPopup, signOut, onAuthStateChanged } from 'firebase/auth'
import { auth, googleProvider } from '../services/firebase'

export function useAuth() {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // çŠ¶æ…‹ã®å®šç¾©
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [user, setUser] = useState<User | null>(null)      // ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼
  const [loading, setLoading] = useState(true)              // èª­ã¿è¾¼ã¿ä¸­ãƒ•ãƒ©ã‚°
  const [error, setError] = useState<string | null>(null)   // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // èªè¨¼çŠ¶æ…‹ã®ç›£è¦–ï¼ˆé‡è¦ï¼ï¼‰
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  useEffect(() => {
    // onAuthStateChanged: Firebaseã®èªè¨¼çŠ¶æ…‹ãŒå¤‰ã‚ã£ãŸã‚‰å‘¼ã°ã‚Œã‚‹
    // - ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸã¨ã
    // - ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ãŸã¨ã
    // - ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ï¼ˆæ—¢å­˜ã®ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’å¾©å…ƒï¼‰
    const unsubscribe = onAuthStateChanged(auth, (user) => {
      setUser(user)       // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ã‚»ãƒƒãƒˆï¼ˆnull = æœªãƒ­ã‚°ã‚¤ãƒ³ï¼‰
      setLoading(false)   // èª­ã¿è¾¼ã¿å®Œäº†
    })

    // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—: ç›£è¦–ã‚’è§£é™¤
    return unsubscribe
  }, [])

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Googleã§ãƒ­ã‚°ã‚¤ãƒ³
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const loginWithGoogle = async () => {
    setError(null)  // ã‚¨ãƒ©ãƒ¼ã‚’ã‚¯ãƒªã‚¢
    try {
      // signInWithPopup: ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã§Googleãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‚’è¡¨ç¤º
      await signInWithPopup(auth, googleProvider)
      // ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ â†’ onAuthStateChanged ãŒè‡ªå‹•ã§å‘¼ã°ã‚Œã‚‹
    } catch (err) {
      setError('ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ')
      console.error(err)
    }
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const logout = async () => {
    try {
      await signOut(auth)
      // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸ â†’ onAuthStateChanged ãŒè‡ªå‹•ã§å‘¼ã°ã‚Œã‚‹
    } catch (err) {
      setError('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ')
      console.error(err)
    }
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // æˆ»ã‚Šå€¤
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  return {
    user,                     // Userã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ or null
    loading,                  // èªè¨¼ç¢ºèªä¸­ã‹
    error,                    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    loginWithGoogle,          // ãƒ­ã‚°ã‚¤ãƒ³é–¢æ•°
    logout,                   // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆé–¢æ•°
    isLoggedIn: !!user,       // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã‹ï¼ˆbooleanï¼‰
  }
}
```

### onAuthStateChanged ã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” onAuthStateChanged ã®å‹•ä½œ                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ã€ãƒ‘ã‚¿ãƒ¼ãƒ³1: ãƒ­ã‚°ã‚¤ãƒ³ã€‘                                                    â”‚
â”‚                                                                             â”‚
â”‚   [ãƒ¦ãƒ¼ã‚¶ãƒ¼] â”€â”€â–¶ [Googleãƒ­ã‚°ã‚¤ãƒ³] â”€â”€â–¶ [Firebase]                             â”‚
â”‚                                           â”‚                                 â”‚
â”‚                                           â–¼                                 â”‚
â”‚   [useAuth] â—€â”€â”€ onAuthStateChanged(user) â”€â”˜                                â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   setUser(user) â†’ ç”»é¢æ›´æ–°                                                  â”‚
â”‚                                                                             â”‚
â”‚   ã€ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰ã€‘                                               â”‚
â”‚                                                                             â”‚
â”‚   [ãƒ–ãƒ©ã‚¦ã‚¶] â”€â”€â–¶ [ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿]                                             â”‚
â”‚                      â”‚                                                      â”‚
â”‚                      â–¼                                                      â”‚
â”‚   [Firebase] â”€â”€ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èªè¨¼æƒ…å ±ã‚’å¾©å…ƒ                          â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [useAuth] â—€â”€â”€ onAuthStateChanged(user)                                   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   è‡ªå‹•çš„ã«ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒå¾©å…ƒï¼                                               â”‚
â”‚                                                                             â”‚
â”‚   ã€ãƒã‚¤ãƒ³ãƒˆã€‘                                                               â”‚
â”‚   Firebase ãŒèªè¨¼çŠ¶æ…‹ã‚’ localStorage ã«ä¿å­˜ã—ã¦ãã‚Œã‚‹                        â”‚
â”‚   â†’ ãƒšãƒ¼ã‚¸ã‚’é–‰ã˜ã¦ã‚‚ã€å†è¨ªå•æ™‚ã«è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³ï¼                                â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. useChat.ts - ãƒãƒ£ãƒƒãƒˆãƒ•ãƒƒã‚¯ã®å®Œå…¨è§£èª¬

### å®Œå…¨ãªã‚³ãƒ¼ãƒ‰

```tsx
/**
 * ãƒãƒ£ãƒƒãƒˆãƒ•ãƒƒã‚¯
 *
 * AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®ä¼šè©±ã‚’ç®¡ç†ã—ã¾ã™ã€‚
 * ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ•ãƒƒã‚¯ã¨é€£æºã—ã¦å‹•ä½œã—ã¾ã™ã€‚
 */
import { useState, useCallback, useEffect } from 'react'
import { sendChatMessage } from '../services/api'
import type { ChatSession } from './useSessions'

/**
 * ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã‚’ç”Ÿæˆ
 * crypto.randomUUID()ã‚’ä½¿ç”¨ã—ã¦è¡çªã®ãªã„IDã‚’ç”Ÿæˆ
 */
function generateUniqueId(): string {
  return crypto.randomUUID()
}

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‹
export interface Message {
  id: string                    // ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªID
  role: 'user' | 'assistant'    // èª°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹
  content: string               // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹
}

interface UseChatOptions {
  activeSession: ChatSession | null
  onMessagesUpdate: (sessionId: string, messages: Message[], threadId: string | null) => void
}

export function useChat(options?: UseChatOptions) {
  const { activeSession, onMessagesUpdate } = options || {}

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // çŠ¶æ…‹ã®å®šç¾©
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [messages, setMessages] = useState<Message[]>(activeSession?.messages || [])
  const [threadId, setThreadId] = useState<string | null>(activeSession?.threadId || null)
  const [isLoading, setIsLoading] = useState(false)
  const [error, setError] = useState<string | null>(null)

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾©å…ƒ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  useEffect(() => {
    if (activeSession) {
      setMessages(activeSession.messages)
      setThreadId(activeSession.threadId)
      setError(null)
    }
  }, [activeSession?.id])  // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒå¤‰ã‚ã£ãŸã‚‰å®Ÿè¡Œ

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const sendMessage = useCallback(async (content: string) => {
    // ç©ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„é€ä¿¡ä¸­ã¯ç„¡è¦–
    if (!content.trim() || isLoading) return

    setError(null)
    setIsLoading(true)

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Step 1: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const userMessage: Message = {
      id: generateUniqueId(),
      role: 'user',
      content,
    }

    const updatedMessagesWithUser = [...messages, userMessage]
    setMessages(updatedMessagesWithUser)

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Step 2: AIã®å¿œç­”ç”¨ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’è¿½åŠ 
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const assistantMessageId = generateUniqueId()
    const assistantMessage: Message = {
      id: assistantMessageId,
      role: 'assistant',
      content: '',  // æœ€åˆã¯ç©º
    }

    const updatedMessagesWithAssistant = [...updatedMessagesWithUser, assistantMessage]
    setMessages(updatedMessagesWithAssistant)

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Step 3: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    try {
      let currentContent = ''

      const newThreadId = await sendChatMessage(
        content,
        threadId,
        (chunk) => {
          // ãƒãƒ£ãƒ³ã‚¯ï¼ˆæ–­ç‰‡ï¼‰ã‚’å—ä¿¡ã™ã‚‹ãŸã³ã«å‘¼ã°ã‚Œã‚‹
          currentContent += chunk

          // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºï¼ï¼‰
          setMessages(prev =>
            prev.map(msg =>
              msg.id === assistantMessageId
                ? { ...msg, content: currentContent }
                : msg
            )
          )
        }
      )

      setThreadId(newThreadId)

      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜
      if (activeSession && onMessagesUpdate) {
        const finalMessages = updatedMessagesWithUser.concat({
          ...assistantMessage,
          content: currentContent,
        })
        onMessagesUpdate(activeSession.id, finalMessages, newThreadId)
      }
    } catch (err) {
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // ã‚¨ãƒ©ãƒ¼å‡¦ç†
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const errorMessage = err instanceof Error ? err.message : 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'
      setError(errorMessage)

      // å¤±æ•—ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
      setMessages(prev => prev.filter(msg => msg.id !== assistantMessageId))

      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¾ã§ä¿å­˜
      if (activeSession && onMessagesUpdate) {
        onMessagesUpdate(activeSession.id, updatedMessagesWithUser, threadId)
      }
    } finally {
      setIsLoading(false)
    }
  }, [threadId, isLoading, messages, activeSession, onMessagesUpdate])

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ä¼šè©±ã‚’ãƒªã‚»ãƒƒãƒˆ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const resetChat = useCallback(() => {
    setMessages([])
    setThreadId(null)
    setError(null)
  }, [])

  return {
    messages,      // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§
    isLoading,     // é€ä¿¡ä¸­ã‹
    error,         // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    sendMessage,   // é€ä¿¡é–¢æ•°
    resetChat,     // ãƒªã‚»ãƒƒãƒˆé–¢æ•°
    threadId,      // ã‚¹ãƒ¬ãƒƒãƒ‰ID
  }
}
```

### useCallback ã¨ã¯ï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ useCallback ã®å½¹å‰²                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  å•é¡Œ:                                                                      â”‚
â”‚    React ã¯å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ãŸã³ã«é–¢æ•°ã‚’æ–°ã—ãä½œã‚Šç›´ã™                         â”‚
â”‚    â†’ å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ¸¡ã™ã¨ã€æ¯å›ã€Œæ–°ã—ã„é–¢æ•°ã€ã¨åˆ¤æ–­ã•ã‚Œã‚‹                   â”‚
â”‚    â†’ ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒç™ºç”Ÿ                                               â”‚
â”‚                                                                             â”‚
â”‚  è§£æ±º:                                                                      â”‚
â”‚    useCallback ã§é–¢æ•°ã‚’ãƒ¡ãƒ¢åŒ–ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰                                   â”‚
â”‚    â†’ ä¾å­˜é…åˆ—ã®å€¤ãŒå¤‰ã‚ã‚‰ãªã„é™ã‚Šã€åŒã˜é–¢æ•°ã‚’å†åˆ©ç”¨                            â”‚
â”‚                                                                             â”‚
â”‚  ä¾‹:                                                                        â”‚
â”‚  const sendMessage = useCallback(async (content) => {                       â”‚
â”‚    // å‡¦ç†                                                                  â”‚
â”‚  }, [threadId, isLoading, ...]);  // ã“ã®å€¤ãŒå¤‰ã‚ã£ãŸã‚‰æ–°ã—ã„é–¢æ•°ã‚’ä½œã‚‹        â”‚
â”‚                                                                             â”‚
â”‚  ğŸ’¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã€‚ãªãã¦ã‚‚å‹•ããŒã€ã‚ã‚‹ã¨åŠ¹ç‡çš„ã€‚                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¡¨ç¤ºã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¡ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¡¨ç¤º                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   [ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰]                        [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰]                       â”‚
â”‚                                                                             â”‚
â”‚   sendMessage("ã“ã‚“ã«ã¡ã¯") â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                                  â”‚
â”‚                                                                             â”‚
â”‚   content = ""              â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "ã“"                             â”‚
â”‚   content = "ã“"            â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "ã‚“"                             â”‚
â”‚   content = "ã“ã‚“"          â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "ã«"                             â”‚
â”‚   content = "ã“ã‚“ã«"        â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "ã¡"                             â”‚
â”‚   content = "ã“ã‚“ã«ã¡"      â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "ã¯"                             â”‚
â”‚   content = "ã“ã‚“ã«ã¡ã¯"    â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "ï¼"                             â”‚
â”‚   content = "ã“ã‚“ã«ã¡ã¯ï¼"  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ [DONE]                           â”‚
â”‚                                                                             â”‚
â”‚   ç”»é¢:                                                                     â”‚
â”‚   ã€Œã“ã€â†’ã€Œã“ã‚“ã€â†’ã€Œã“ã‚“ã«ã€â†’ã€Œã“ã‚“ã«ã¡ã€â†’ã€Œã“ã‚“ã«ã¡ã¯ã€â†’ã€Œã“ã‚“ã«ã¡ã¯ï¼ã€        â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ onChunk ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ setMessages ã‚’å‘¼ã¶                                â”‚
â”‚      â†’ æ¯å›ç”»é¢ãŒæ›´æ–°ã•ã‚Œã‚‹                                                  â”‚
â”‚      â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ–‡å­—ãŒå¢—ãˆã¦ã„ãã®ã‚’è¦‹ã‚Œã‚‹ï¼                     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. useSessions.ts - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®å®Œå…¨è§£èª¬

è¤‡æ•°ã®ä¼šè©±ã‚’ç®¡ç†ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ | æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹ |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ | éå»ã®ä¼šè©±ã«æˆ»ã‚‹ |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤ | ä¸è¦ãªä¼šè©±ã‚’å‰Šé™¤ |
| è‡ªå‹•ä¿å­˜ | ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ |
| ã‚¿ã‚¤ãƒˆãƒ«è‡ªå‹•ç”Ÿæˆ | æœ€åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä½œæˆ |

### å®Œå…¨ãªã‚³ãƒ¼ãƒ‰

```tsx
/**
 * ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ•ãƒƒã‚¯
 *
 * è¤‡æ•°ã®ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«æ°¸ç¶šåŒ–ã—ã¾ã™ã€‚
 *
 * ã€åˆ¶é™äº‹é …ã€‘
 * - æœ€å¤§10ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¾ã§ä¿å­˜ï¼ˆå®¹é‡åˆ¶é™ã®ãŸã‚ï¼‰
 * - ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ï¼ˆãƒ‡ãƒã‚¤ã‚¹é–“åŒæœŸãªã—ï¼‰
 */
import { useState, useCallback, useEffect } from 'react'
import type { Message } from './useChat'

/** ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã‚­ãƒ¼ */
const STORAGE_KEY = 'chat_sessions'

/**
 * æœ€å¤§ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°
 * - ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å®¹é‡åˆ¶é™ï¼ˆ5-10MBï¼‰ã‚’è€ƒæ…®
 * - 1ã‚»ãƒƒã‚·ãƒ§ãƒ³ç´„8KBï¼ˆ20ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æƒ³å®šï¼‰Ã— 10 = ç´„80KB
 */
const MAX_SESSIONS = 10

/** ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ« */
const DEFAULT_SESSION_TITLE = 'æ–°ã—ã„ä¼šè©±'

/**
 * ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å‹å®šç¾©
 */
export interface ChatSession {
  id: string            // ä¸€æ„ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
  title: string         // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«
  messages: Message[]   // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´
  threadId: string | null  // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã®ä¼šè©±ã‚¹ãƒ¬ãƒƒãƒ‰ID
  createdAt: number     // ä½œæˆæ—¥æ™‚ï¼ˆUnix timestampï¼‰
  updatedAt: number     // æœ€çµ‚æ›´æ–°æ—¥æ™‚
}

/**
 * ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”Ÿæˆ
 * å½¢å¼: session_{timestamp}_{ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—}
 */
function generateSessionId(): string {
  return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
}

/**
 * æ–°ã—ã„ç©ºã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
 */
function createNewSession(): ChatSession {
  return {
    id: generateSessionId(),
    title: DEFAULT_SESSION_TITLE,
    messages: [],
    threadId: null,
    createdAt: Date.now(),
    updatedAt: Date.now(),
  }
}

/**
 * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
 */
function loadSessionsFromStorage(): ChatSession[] {
  try {
    const stored = localStorage.getItem(STORAGE_KEY)
    if (stored) {
      return JSON.parse(stored)
    }
  } catch {
    // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ç©ºé…åˆ—ã‚’è¿”ã™ï¼ˆãƒ‡ãƒ¼ã‚¿ç ´ææ™‚ã®å®‰å…¨å¯¾ç­–ï¼‰
  }
  return []
}

/**
 * ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
 */
function saveSessionsToStorage(sessions: ChatSession[]): void {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(sessions))
  } catch {
    // å®¹é‡è¶…éãªã©ã®ã‚¨ãƒ©ãƒ¼ã¯æ¡ã‚Šã¤ã¶ã™
  }
}

/**
 * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‹ã‚‰ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç”Ÿæˆ
 * - æœ€å¤§20æ–‡å­—ã¾ã§
 * - æ”¹è¡Œã¯ã‚¹ãƒšãƒ¼ã‚¹ã«å¤‰æ›
 */
function generateTitleFromMessage(content: string): string {
  const maxLength = 20
  const trimmed = content.trim().replace(/\n/g, ' ')
  if (trimmed.length <= maxLength) {
    return trimmed
  }
  return trimmed.substring(0, maxLength) + '...'
}

/**
 * ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ•ãƒƒã‚¯
 */
export function useSessions() {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§
  // useState ã®åˆæœŸåŒ–é–¢æ•°ã‚’ä½¿ç”¨ï¼ˆåˆå›ã®ã¿å®Ÿè¡Œï¼‰
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [sessions, setSessions] = useState<ChatSession[]>(() => {
    const loaded = loadSessionsFromStorage()
    return loaded.length === 0 ? [createNewSession()] : loaded
  })

  // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ID
  const [activeSessionId, setActiveSessionId] = useState<string>(
    () => sessions[0]?.id || ''
  )

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ›´æ™‚ã«è‡ªå‹•ä¿å­˜
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  useEffect(() => {
    saveSessionsToStorage(sessions)
  }, [sessions])

  // ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚»ãƒƒã‚·ãƒ§ãƒ³
  const activeSession = sessions.find(s => s.id === activeSessionId) || sessions[0]

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const createSession = useCallback(() => {
    const newSession = createNewSession()
    setSessions(prev => {
      const updated = [newSession, ...prev]  // å…ˆé ­ã«è¿½åŠ 
      // æœ€å¤§æ•°ã‚’è¶…ãˆãŸã‚‰å¤ã„ã‚‚ã®ã‚’å‰Šé™¤
      if (updated.length > MAX_SESSIONS) {
        return updated.slice(0, MAX_SESSIONS)
      }
      return updated
    })
    setActiveSessionId(newSession.id)
    return newSession.id
  }, [])

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const switchSession = useCallback((sessionId: string) => {
    setActiveSessionId(sessionId)
  }, [])

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const closeSession = useCallback((sessionId: string) => {
    setSessions(prev => {
      const remainingSessions = prev.filter(s => s.id !== sessionId)

      // å…¨ã¦å‰Šé™¤ã•ã‚ŒãŸå ´åˆã¯æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
      if (remainingSessions.length === 0) {
        const newSession = createNewSession()
        setActiveSessionId(newSession.id)
        return [newSession]
      }

      // å‰Šé™¤ã•ã‚ŒãŸã®ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ã ã£ãŸå ´åˆ
      if (sessionId === activeSessionId) {
        const deletedIndex = prev.findIndex(s => s.id === sessionId)
        const nextIndex = Math.min(deletedIndex, remainingSessions.length - 1)
        setActiveSessionId(remainingSessions[nextIndex].id)
      }

      return remainingSessions
    })
  }, [activeSessionId])

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const updateSessionMessages = useCallback((
    sessionId: string,
    messages: Message[],
    threadId: string | null
  ) => {
    setSessions(prev => prev.map(session => {
      if (session.id !== sessionId) return session

      // ã‚¿ã‚¤ãƒˆãƒ«è‡ªå‹•ç”Ÿæˆï¼ˆã¾ã ã€Œæ–°ã—ã„ä¼šè©±ã€ã®å ´åˆã®ã¿ï¼‰
      let title = session.title
      if (title === DEFAULT_SESSION_TITLE && messages.length > 0) {
        const firstUserMessage = messages.find(m => m.role === 'user')
        if (firstUserMessage) {
          title = generateTitleFromMessage(firstUserMessage.content)
        }
      }

      return {
        ...session,
        messages,
        threadId,
        title,
        updatedAt: Date.now(),
      }
    }))
  }, [])

  return {
    sessions,              // ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§
    activeSession,         // ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³
    activeSessionId,       // ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
    createSession,         // æ–°è¦ä½œæˆ
    switchSession,         // åˆ‡ã‚Šæ›¿ãˆ
    closeSession,          // å‰Šé™¤
    updateSessionMessages, // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ›´æ–°
  }
}
```

### ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¾ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ãƒ–ãƒ©ã‚¦ã‚¶ã«å†…è”µã•ã‚ŒãŸã€Œç°¡æ˜“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€                                    â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  localStorage                                                        â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚  ã‚­ãƒ¼           â”‚  å€¤                                          â”‚  â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚   â”‚  â”‚ chat_sessions   â”‚ [{"id":"session_123","title":"å¤©æ°—ã«ã¤ã„ã¦",â”‚  â”‚  â”‚
â”‚   â”‚  â”‚                 â”‚   "messages":[...]}, {...}]                 â”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   ã€ç‰¹å¾´ã€‘                                                                   â”‚
â”‚   âœ… ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿ãŒæ®‹ã‚‹                                           â”‚
â”‚   âœ… ç´„ 5-10MB ã¾ã§ä¿å­˜å¯èƒ½                                                  â”‚
â”‚   âŒ ä»–ã®ãƒ‡ãƒã‚¤ã‚¹ã¨ã¯åŒæœŸã•ã‚Œãªã„                                             â”‚
â”‚   âŒ ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã§æ¶ˆãˆã‚‹                                             â”‚
â”‚                                                                             â”‚
â”‚   ã€ä½¿ã„æ–¹ã€‘                                                                 â”‚
â”‚   localStorage.setItem('key', 'value')  // ä¿å­˜                             â”‚
â”‚   localStorage.getItem('key')           // å–å¾—                             â”‚
â”‚   localStorage.removeItem('key')        // å‰Šé™¤                             â”‚
â”‚                                                                             â”‚
â”‚   âš ï¸ æ³¨æ„: æ–‡å­—åˆ—ã—ã‹ä¿å­˜ã§ããªã„                                             â”‚
â”‚   â†’ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ JSON.stringify() ã§æ–‡å­—åˆ—ã«å¤‰æ›                            â”‚
â”‚   â†’ å–å¾—æ™‚ã¯ JSON.parse() ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æˆ»ã™                                â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. api.ts - APIé€šä¿¡ã®å®Œå…¨è§£èª¬

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã®é€šä¿¡ã‚’æ‹…å½“ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚

### å®Œå…¨ãªã‚³ãƒ¼ãƒ‰

```tsx
/**
 * APIé€šä¿¡ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
 *
 * ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¨ã®é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚
 */
import { auth } from './firebase'

// APIãƒ™ãƒ¼ã‚¹URLï¼ˆç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ï¼‰
const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8080'

/**
 * èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
 *
 * Firebase ã‹ã‚‰IDãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ã€‚
 * ã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ãŒãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¸ã®ã€Œèªè¨¼ã®è¨¼ã€ã«ãªã‚‹ã€‚
 */
async function getAuthToken(): Promise<string> {
  const user = auth.currentUser
  if (!user) {
    throw new Error('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™')
  }
  return user.getIdToken()
}

/**
 * èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”Ÿæˆ
 *
 * HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ä»˜åŠ ã™ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½œæˆã€‚
 * Bearer ãƒˆãƒ¼ã‚¯ãƒ³å½¢å¼ã§èªè¨¼æƒ…å ±ã‚’é€ã‚‹ã€‚
 */
async function createAuthHeaders(): Promise<HeadersInit> {
  const token = await getAuthToken()
  return {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`,  // ã“ã‚ŒãŒèªè¨¼ã®è¨¼ï¼
  }
}

/**
 * ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼‰
 *
 * @param message ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
 * @param threadId ã‚¹ãƒ¬ãƒƒãƒ‰IDï¼ˆçœç•¥å¯ï¼‰
 * @param onChunk ãƒãƒ£ãƒ³ã‚¯å—ä¿¡æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
 * @returns ã‚¹ãƒ¬ãƒƒãƒ‰ID
 */
export async function sendChatMessage(
  message: string,
  threadId: string | null,
  onChunk: (chunk: string) => void
): Promise<string> {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Step 1: èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½œæˆ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const headers = await createAuthHeaders()

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Step 2: APIã«POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆ
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const response = await fetch(`${API_BASE_URL}/chat`, {
    method: 'POST',
    headers,
    body: JSON.stringify({
      message,
      thread_id: threadId,
    }),
  })

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Step 3: ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (!response.ok) {
    const error = await response.json()
    throw new Error(error.error || 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ')
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Step 4: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰ã‚¹ãƒ¬ãƒƒãƒ‰IDã‚’å–å¾—
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const newThreadId = response.headers.get('X-Thread-Id') || threadId || ''

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Step 5: Server-Sent Events ã‚’å‡¦ç†
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const reader = response.body?.getReader()
  // stream: true ã§æ—¥æœ¬èªã®æ–‡å­—åŒ–ã‘ã‚’é˜²æ­¢
  const decoder = new TextDecoder()

  if (!reader) {
    throw new Error('ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®èª­ã¿å–ã‚Šã«å¤±æ•—ã—ã¾ã—ãŸ')
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Step 6: ãƒãƒ£ãƒ³ã‚¯ã‚’èª­ã¿ç¶šã‘ã‚‹
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  while (true) {
    const { done, value } = await reader.read()
    if (done) break

    // ãƒã‚¤ãƒŠãƒª â†’ ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›
    const text = decoder.decode(value, { stream: true })
    const lines = text.split('\n')

    // å„è¡Œã‚’å‡¦ç†
    for (const line of lines) {
      if (line.startsWith('data: ')) {
        const data = line.slice(6)  // "data: " ã‚’é™¤å»
        if (data === '[DONE]') {
          break
        }
        if (data.startsWith('[ERROR]')) {
          throw new Error(data.slice(8))
        }
        onChunk(data)  // ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’å‘¼ã¶
      }
    }
  }

  return newThreadId
}
```

### SSEï¼ˆServer-Sent Eventsï¼‰ã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¡ Server-Sent Events (SSE)                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ã€æ™®é€šã®HTTPé€šä¿¡ã€‘                                                          â”‚
â”‚                                                                             â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â”€â”€â”€â”€ãƒªã‚¯ã‚¨ã‚¹ãƒˆâ”€â”€â”€â”€â–¶ [ã‚µãƒ¼ãƒãƒ¼]                               â”‚
â”‚                                        â”‚                                    â”‚
â”‚                      ï¼ˆ3ç§’å¾…ã¡...ï¼‰      â”‚                                   â”‚
â”‚                                        â–¼                                    â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆå…¨éƒ¨ï¼‰â”€â”€ [ã‚µãƒ¼ãƒãƒ¼]                           â”‚
â”‚                                                                             â”‚
â”‚  ã€SSEã€‘                                                                     â”‚
â”‚                                                                             â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â”€â”€â”€â”€ãƒªã‚¯ã‚¨ã‚¹ãƒˆâ”€â”€â”€â”€â–¶ [ã‚µãƒ¼ãƒãƒ¼]                               â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€"data: ã“"â”€â”€â”€â”€â”€ [ã‚µãƒ¼ãƒãƒ¼]                              â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€"data: ã‚“"â”€â”€â”€â”€â”€ [ã‚µãƒ¼ãƒãƒ¼]                              â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€"data: ã«"â”€â”€â”€â”€â”€ [ã‚µãƒ¼ãƒãƒ¼]                              â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€"data: ã¡"â”€â”€â”€â”€â”€ [ã‚µãƒ¼ãƒãƒ¼]                              â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€"data: ã¯"â”€â”€â”€â”€â”€ [ã‚µãƒ¼ãƒãƒ¼]                              â”‚
â”‚   [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â—€â”€â”€â”€"data: [DONE]"â”€ [ã‚µãƒ¼ãƒãƒ¼]                              â”‚
â”‚                                                                             â”‚
â”‚   â†’ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç”»é¢ã«æ–‡å­—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼                                    â”‚
â”‚                                                                             â”‚
â”‚  ã€SSEã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã€‘                                                         â”‚
â”‚                                                                             â”‚
â”‚   data: æ–‡å­—åˆ—\n                                                            â”‚
â”‚   data: æ–‡å­—åˆ—\n                                                            â”‚
â”‚   data: [DONE]\n                                                            â”‚
â”‚                                                                             â”‚
â”‚   å„è¡ŒãŒ "data: " ã§å§‹ã¾ã‚‹                                                   â”‚
â”‚   æœ€å¾Œã¯ "[DONE]" ã§çµ‚äº†ã‚’çŸ¥ã‚‰ã›ã‚‹                                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### TextDecoder ã®é‡è¦æ€§

```tsx
// stream: true ãŒãªã„ã¨æ—¥æœ¬èªãŒæ–‡å­—åŒ–ã‘ã™ã‚‹ï¼

// æ‚ªã„ä¾‹
const text = decoder.decode(value);  // âŒ æ—¥æœ¬èªãŒåŒ–ã‘ã‚‹å¯èƒ½æ€§

// è‰¯ã„ä¾‹
const text = decoder.decode(value, { stream: true });  // âœ… æ­£ã—ãå‡¦ç†

// ãªãœï¼Ÿ
// UTF-8ã§ã¯æ—¥æœ¬èª1æ–‡å­— = 3ãƒã‚¤ãƒˆ
// ãƒãƒ£ãƒ³ã‚¯ã®å¢ƒç•Œã§åˆ†æ–­ã•ã‚Œã‚‹ã¨...
// ä¾‹: "æ—¥" = [E6, 97, A5]
//     ãƒãƒ£ãƒ³ã‚¯1: [E6, 97]  â† ä¸å®Œå…¨ï¼
//     ãƒãƒ£ãƒ³ã‚¯2: [A5, ...]
// stream: true ã§ä¸å®Œå…¨ãªãƒã‚¤ãƒˆã‚’ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ã—ã¦ãã‚Œã‚‹
```

---

## 10. firebase.ts - FirebaseåˆæœŸåŒ–

Firebase SDKã®åˆæœŸåŒ–ã‚’è¡Œã†ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

### å®Œå…¨ãªã‚³ãƒ¼ãƒ‰

```tsx
/**
 * FirebaseåˆæœŸåŒ–
 *
 * ã€è¨­å®šæ–¹æ³•ã€‘
 * .envãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„:
 * - VITE_FIREBASE_API_KEY
 * - VITE_FIREBASE_AUTH_DOMAIN
 * - VITE_FIREBASE_PROJECT_ID
 */
import { initializeApp } from 'firebase/app'
import { getAuth, GoogleAuthProvider } from 'firebase/auth'

// Firebaseè¨­å®šï¼ˆç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ï¼‰
const firebaseConfig = {
  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
}

// FirebaseåˆæœŸåŒ–
const app = initializeApp(firebaseConfig)

// èªè¨¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
export const auth = getAuth(app)

// Googleãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€
export const googleProvider = new GoogleAuthProvider()
```

### ç’°å¢ƒå¤‰æ•°ã«ã¤ã„ã¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” ç’°å¢ƒå¤‰æ•°ã¨ Vite                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ã€.envãƒ•ã‚¡ã‚¤ãƒ«ã€‘                                                            â”‚
â”‚                                                                             â”‚
â”‚  frontend/.env                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ VITE_FIREBASE_API_KEY=AIza...                                        â”‚   â”‚
â”‚  â”‚ VITE_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com              â”‚   â”‚
â”‚  â”‚ VITE_FIREBASE_PROJECT_ID=your-project-id                            â”‚   â”‚
â”‚  â”‚ VITE_API_BASE_URL=https://your-api.run.app                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ã€Viteã§ã®ç’°å¢ƒå¤‰æ•°ã®ãƒ«ãƒ¼ãƒ«ã€‘                                                 â”‚
â”‚                                                                             â”‚
â”‚  âœ… VITE_ ã§å§‹ã¾ã‚‹å¤‰æ•°ã ã‘ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä½¿ãˆã‚‹                             â”‚
â”‚  âœ… import.meta.env.VITE_XXX ã§ã‚¢ã‚¯ã‚»ã‚¹                                      â”‚
â”‚  âŒ VITE_ ãŒãªã„å¤‰æ•°ã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰         â”‚
â”‚                                                                             â”‚
â”‚  ã€ãªãœç’°å¢ƒå¤‰æ•°ã‚’ä½¿ã†ï¼Ÿã€‘                                                     â”‚
â”‚                                                                             â”‚
â”‚  1. ç§˜å¯†æƒ…å ±ã‚’ã‚³ãƒ¼ãƒ‰ã«ç›´æ›¸ãã—ãªã„                                            â”‚
â”‚  2. é–‹ç™º/æœ¬ç•ªã§è¨­å®šã‚’åˆ‡ã‚Šæ›¿ãˆã‚„ã™ã„                                           â”‚
â”‚  3. .gitignore ã§ .env ã‚’é™¤å¤– â†’ Gitã«ç§˜å¯†æƒ…å ±ãŒå…¥ã‚‰ãªã„                       â”‚
â”‚                                                                             â”‚
â”‚  âš ï¸ æ³¨æ„: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ç’°å¢ƒå¤‰æ•°ã¯çµå±€ãƒ–ãƒ©ã‚¦ã‚¶ã«é€ã‚‰ã‚Œã‚‹                      â”‚
â”‚     â†’ æœ¬å½“ã®ç§˜å¯†ï¼ˆAPIã‚­ãƒ¼ãªã©ï¼‰ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ç½®ã                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. TypeScriptã®å‹ã‚·ã‚¹ãƒ†ãƒ 

TypeScriptã¯JavaScriptã«ã€Œå‹ã€ã‚’è¿½åŠ ã—ãŸè¨€èªã§ã™ã€‚
é–“é•ã„ã‚’äº‹å‰ã«é˜²ã’ã‚‹ï¼

### åŸºæœ¬çš„ãªå‹

```tsx
// ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹
const name: string = "å¤ªéƒ";
const age: number = 25;
const isActive: boolean = true;

// é…åˆ—
const numbers: number[] = [1, 2, 3];
const names: string[] = ["Alice", "Bob"];

// ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹
type User = {
  id: string;
  name: string;
  email: string;
};

const user: User = {
  id: "1",
  name: "å¤ªéƒ",
  email: "taro@example.com",
};

// user.age = 25;  // âŒ ã‚¨ãƒ©ãƒ¼ï¼Userå‹ã«ageã¯ãªã„
```

### interface ã¨ type

```tsx
// interface: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å½¢ã‚’å®šç¾©
interface Message {
  id: string;
  role: 'user' | 'assistant';  // ãƒªãƒ†ãƒ©ãƒ«å‹ï¼ˆã“ã®2ã¤ã ã‘è¨±å¯ï¼‰
  content: string;
}

// type: ä»»æ„ã®å‹ã‚’å®šç¾©
type MessageRole = 'user' | 'assistant';

// ã©ã¡ã‚‰ã‚’ä½¿ã†ï¼Ÿ
// â†’ åŸºæœ¬çš„ã«ã©ã¡ã‚‰ã§ã‚‚OK
// â†’ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ interface ãŒä¸€èˆ¬çš„
// â†’ è¤‡é›‘ãªå‹ã‚„ Union ã¯ type ãŒä¾¿åˆ©
```

### Unionå‹ã¨Optional

```tsx
// Unionå‹: è¤‡æ•°ã®å‹ã®ã©ã‚Œã‹
type Status = 'loading' | 'success' | 'error';

let status: Status = 'loading';
status = 'success';  // âœ… OK
// status = 'pending';  // âŒ ã‚¨ãƒ©ãƒ¼ï¼

// Optionalï¼ˆçœç•¥å¯èƒ½ï¼‰
interface User {
  id: string;
  name: string;
  email?: string;  // ? ã§çœç•¥å¯èƒ½ã«
}

const user1: User = { id: "1", name: "å¤ªéƒ" };  // âœ… emailãªã—ã§ã‚‚OK
const user2: User = { id: "2", name: "èŠ±å­", email: "hanako@example.com" };  // âœ…
```

### ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹

```tsx
// ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹: å‹ã‚’å¼•æ•°ã®ã‚ˆã†ã«æ¸¡ã›ã‚‹
function useState<T>(initialValue: T): [T, (value: T) => void] {
  // ...
}

// ä½¿ã†ã¨ã
const [count, setCount] = useState<number>(0);
const [name, setName] = useState<string>("å¤ªéƒ");
const [user, setUser] = useState<User | null>(null);

// <T> ã¯ã€Œå‹å¼•æ•°ã€
// å‘¼ã³å‡ºã—å´ãŒå…·ä½“çš„ãªå‹ã‚’æŒ‡å®šã§ãã‚‹
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¡ TypeScript ã®ãƒ¡ãƒªãƒƒãƒˆ                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. è£œå®ŒãŒåŠ¹ã                                                               â”‚
â”‚     user. ã¨æ‰“ã¤ã¨ id, name, email ãŒå€™è£œã«å‡ºã‚‹ï¼                            â”‚
â”‚                                                                             â”‚
â”‚  2. é–“é•ã„ã‚’äº‹å‰ã«ç™ºè¦‹                                                       â”‚
â”‚     message.rolr ã¨æ‰“ã¤ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆrole ã®typoï¼‰                               â”‚
â”‚                                                                             â”‚
â”‚  3. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå®‰å…¨                                                    â”‚
â”‚     é–¢æ•°åã‚„å‹ã‚’å¤‰ãˆã‚‹ã¨ã€å½±éŸ¿ç®‡æ‰€ãŒå…¨ã¦åˆ†ã‹ã‚‹                                 â”‚
â”‚                                                                             â”‚
â”‚  4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä»£ã‚ã‚Š                                                       â”‚
â”‚     å‹å®šç¾©ã‚’è¦‹ã‚Œã°ã€ä½•ãŒå¿…è¦ã‹åˆ†ã‹ã‚‹                                          â”‚
â”‚                                                                             â”‚
â”‚  âš ï¸ æ³¨æ„: å®Ÿè¡Œæ™‚ã«ã¯å‹æƒ…å ±ã¯æ¶ˆãˆã‚‹                                            â”‚
â”‚     â†’ å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ã¯é˜²ã’ãªã„ï¼ˆã‚ãã¾ã§é–‹ç™ºæ™‚ã®ãƒã‚§ãƒƒã‚¯ï¼‰                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 12. å…¨ä½“ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ãŒã©ã†é€£æºã™ã‚‹ã‹ã€å…¨ä½“åƒã‚’æŠŠæ¡ã—ã¾ã—ã‚‡ã†ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ ãƒãƒ£ãƒƒãƒˆé€ä¿¡ã®å®Œå…¨ãƒ•ãƒ­ãƒ¼                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   [ãƒ¦ãƒ¼ã‚¶ãƒ¼] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›                                                  â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [ChatScreen] onSendMessage(text) å‘¼ã³å‡ºã—                                 â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [useChat] sendMessage(content)                                           â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”œâ”€â”€ setMessages([...messages, userMessage])  â† ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”œâ”€â”€ setMessages([..., assistantMessage])  â† ç©ºã®AIãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ        â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [api.ts] sendChatMessage(content, threadId, onChunk)                     â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”œâ”€â”€ getAuthToken()  â† IDãƒˆãƒ¼ã‚¯ãƒ³å–å¾—                                  â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”œâ”€â”€ fetch('/chat', { headers: { Authorization: 'Bearer ...' } })     â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚       â”‚  ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼                                                      â”‚
â”‚       â”‚  ãƒ»AI ã«å•ã„åˆã‚ã›                                                   â”‚
â”‚       â”‚  ãƒ»ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã§è¿”ç­”                                              â”‚
â”‚   â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [api.ts] reader.read() ã§ãƒãƒ£ãƒ³ã‚¯ã‚’å—ä¿¡                                   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”œâ”€â”€ onChunk("ã“") â†’ setMessages æ›´æ–°                                  â”‚
â”‚       â”œâ”€â”€ onChunk("ã‚“") â†’ setMessages æ›´æ–°                                  â”‚
â”‚       â”œâ”€â”€ onChunk("ã«") â†’ setMessages æ›´æ–°                                  â”‚
â”‚       â”œâ”€â”€ ...                                                               â”‚
â”‚       â”œâ”€â”€ onChunk("[DONE]") â†’ çµ‚äº†                                          â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [useChat] â†’ [useSessions] updateSessionMessages()                        â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   [useSessions] â†’ localStorage ã«ä¿å­˜                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ã¾ã¨ã‚

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘   ğŸ“ ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨                                                       â•‘
â•‘                                                                              â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚ æ¦‚å¿µ              â”‚ ãƒã‚¤ãƒ³ãƒˆ                                         â”‚  â•‘
â•‘   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘   â”‚ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ    â”‚ ç”»é¢ã®ãƒ‘ãƒ¼ãƒ„ã€‚çµ„ã¿åˆã‚ã›ã¦UIã‚’ä½œã‚‹                 â”‚  â•‘
â•‘   â”‚ useState         â”‚ çŠ¶æ…‹ã‚’æŒã¤ã€‚å¤‰æ›´ã™ã‚‹ã¨å†æç”»ã•ã‚Œã‚‹                  â”‚  â•‘
â•‘   â”‚ useEffect        â”‚ å‰¯ä½œç”¨ã‚’å®Ÿè¡Œã€‚ãƒã‚¦ãƒ³ãƒˆæ™‚ã‚„ãƒ‡ãƒ¼ã‚¿å¤‰æ›´æ™‚ã«å‡¦ç†        â”‚  â•‘
â•‘   â”‚ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯   â”‚ ãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨ã€‚useAuth, useChatãªã©              â”‚  â•‘
â•‘   â”‚ TypeScript       â”‚ å‹ã§å®‰å…¨ã«ã€‚é–“é•ã„ã‚’äº‹å‰ã«é˜²ã                      â”‚  â•‘
â•‘   â”‚ SSE              â”‚ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚‹                       â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                              â•‘
â•‘   âœ… useAuth: Firebaseèªè¨¼ã®çŠ¶æ…‹ç®¡ç†                                         â•‘
â•‘   âœ… useChat: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€å—ä¿¡ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†                            â•‘
â•‘   âœ… useSessions: è¤‡æ•°ä¼šè©±ã®ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜                                      â•‘
â•‘   âœ… api.ts: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã®HTTPé€šä¿¡                                        â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## æ¬¡ã«èª­ã‚€ã¹ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| é †ç•ª | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å†…å®¹ |
|------|-------------|------|
| 1 | [05_ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®æµã‚Œ.md](./05_ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®æµã‚Œ.md) | ç’°å¢ƒæ§‹ç¯‰ã®æ‰‹é † |
| 2 | [FLOW_01_ãƒãƒ£ãƒƒãƒˆé€ä¿¡ã®æµã‚Œ.md](./FLOW_01_ãƒãƒ£ãƒƒãƒˆé€ä¿¡ã®æµã‚Œ.md) | è©³ç´°ãªãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ |
| 3 | [FLOW_02_ãƒ­ã‚°ã‚¤ãƒ³ã®æµã‚Œ.md](./FLOW_02_ãƒ­ã‚°ã‚¤ãƒ³ã®æµã‚Œ.md) | èªè¨¼ãƒ•ãƒ­ãƒ¼ã®è©³ç´° |

---

## ç·´ç¿’å•é¡Œ

### Q1: useState ã«ã¤ã„ã¦

```tsx
const [count, setCount] = useState(0);

// ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ count ã¯ä½•ã«ãªã‚‹ï¼Ÿ
setCount(count + 1);
setCount(count + 1);
setCount(count + 1);

// A. 3
// B. 1
// C. 0
```

<details>
<summary>ç­”ãˆã‚’è¦‹ã‚‹</summary>

**ç­”ãˆ: B. 1**

ç†ç”±: setCount ã¯éåŒæœŸçš„ã«æ›´æ–°ã•ã‚Œã‚‹ãŸã‚ã€3å›å‘¼ã‚“ã§ã‚‚å…¨ã¦ `0 + 1 = 1` ã«ãªã‚‹ã€‚

é€£ç¶šã—ã¦åŠ ç®—ã—ãŸã„å ´åˆã¯:
```tsx
setCount(prev => prev + 1);
setCount(prev => prev + 1);
setCount(prev => prev + 1);
// â†’ 3 ã«ãªã‚‹
```

</details>

### Q2: useEffect ã®ä¾å­˜é…åˆ—

```tsx
useEffect(() => {
  console.log("å®Ÿè¡Œã•ã‚Œã¾ã—ãŸ");
}, [userId]);
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã„ã¤å®Ÿè¡Œã•ã‚Œã‚‹ï¼Ÿ

<details>
<summary>ç­”ãˆã‚’è¦‹ã‚‹</summary>

**ç­”ãˆ:**
1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæœ€åˆã«è¡¨ç¤ºã•ã‚ŒãŸã¨ãï¼ˆãƒã‚¦ãƒ³ãƒˆæ™‚ï¼‰
2. `userId` ã®å€¤ãŒå¤‰ã‚ã£ãŸã¨ã

`userId` ãŒåŒã˜å€¤ã®ã¾ã¾ãªã‚‰ã€å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã¦ã‚‚å®Ÿè¡Œã•ã‚Œãªã„ã€‚

</details>

### Q3: TypeScript ã®å‹ã‚¨ãƒ©ãƒ¼

```tsx
interface User {
  id: string;
  name: string;
}

const user: User = {
  id: 1,
  name: "å¤ªéƒ",
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ä½•ãŒå•é¡Œï¼Ÿ

<details>
<summary>ç­”ãˆã‚’è¦‹ã‚‹</summary>

**ç­”ãˆ:** `id` ã®å‹ãŒé•ã†

`id` ã¯ `string` å‹ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãŒã€`1`ï¼ˆnumberï¼‰ã‚’æ¸¡ã—ã¦ã„ã‚‹ã€‚

æ­£ã—ãã¯:
```tsx
const user: User = {
  id: "1",  // æ–‡å­—åˆ—ã«ã™ã‚‹
  name: "å¤ªéƒ",
};
```

</details>
