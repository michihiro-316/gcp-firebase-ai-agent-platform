# AIカスタマイズ

AIの応答を変更する方法を説明します。

---

## 基本: SYSTEM_PROMPT を変更する

AIの性格・役割は `SYSTEM_PROMPT` で決まります。

### ファイルの場所

```
backend/src/agents/_template/agent.py
```

### 変更箇所

```python
# =============================================
# ここを編集してAIをカスタマイズ
# =============================================

# AIの性格・役割（ここを変更するとAIの応答が変わる）
SYSTEM_PROMPT = """あなたは親切で丁寧なAIアシスタントです。
ユーザーの質問に対して、わかりやすく簡潔に回答してください。
日本語で回答してください。"""
```

---

## 実験してみよう

### 実験1: 関西弁AIに変える

```python
SYSTEM_PROMPT = """あなたは関西弁で話すAIアシスタントやで。
ユーザーの質問にフレンドリーに答えてや。
「やで」「やん」「なんでやねん」などを使ってな。"""
```

**結果例:**
```
ユーザー: こんにちは
AI: おお、こんにちは〜！元気にしとる？なんか聞きたいことあったら言うてな！
```

### 実験2: 専門家AIに変える

```python
SYSTEM_PROMPT = """あなたはPythonプログラミングの専門家です。
コードの書き方、デバッグ方法、ベストプラクティスを教えてください。
初心者にも分かりやすく説明してください。"""
```

### 実験3: キャラクターAIに変える

```python
SYSTEM_PROMPT = """あなたは「AIくん」という名前のAIキャラクターです。
一人称は「ボク」で、語尾に「〜だよ」「〜なんだ」をつけて話します。
明るく元気な性格で、ユーザーを励まします。"""
```

---

## 変更を確認する手順

### 1. agent.py を編集

```bash
vim backend/src/agents/_template/agent.py
# または VSCode で開く
```

### 2. バックエンドを再起動

```bash
cd backend
# Ctrl+C で停止してから再起動
functions-framework --target=main --port=8080
```

### 3. ブラウザでチャット

http://localhost:5173/ でチャットして確認

---

## 顧客別にカスタマイズする場合

### 1. テンプレートをコピー

```bash
cd backend/src/agents
cp -r _template acme-corp
```

### 2. agent.py を編集

```python
# agents/acme-corp/agent.py

class AcmeCorpAgent(BaseAgent):
    SYSTEM_PROMPT = """あなたはACME社の専門AIアシスタントです。
ACME社の製品・サービスに関する質問に答えてください。"""
```

### 3. main.py に登録

```python
from agents.acme_corp.agent import AcmeCorpAgent

AGENTS = {
    "template": TemplateAgent,
    "acme-corp": AcmeCorpAgent,  # 追加
}
```

### 4. 設定ファイルを作成

```bash
cp customer-configs/template.env customer-configs/acme-corp.env
```

```env
CUSTOMER_ID=acme-corp
DEFAULT_AGENT=acme-corp
```

---

## その他のカスタマイズ

### モデルを変更

```python
# より高性能なモデルを使う（コストは上がる）
MODEL_NAME = "gemini-1.5-pro"
```

### 会話履歴の量を変更

```python
# より長い会話を記憶する（コストは上がる）
MAX_HISTORY_MESSAGES = 40  # 約20往復分
```

### 応答の創造性を変更

```python
# temperature を変更
self.llm = ChatVertexAI(
    model=self.MODEL_NAME,
    temperature=0.3,  # 低い = 一貫した応答、高い = 創造的な応答
    ...
)
```

---

## 注意事項

- プロンプトを変更したら必ず再起動が必要
- 本番環境に反映するにはデプロイが必要
- モデル変更はコストに影響する

---

## 次のステップ

- より複雑なエージェント（ツール使用、条件分岐）は LangGraph のドキュメントを参照
- https://langchain-ai.github.io/langgraph/
